\documentclass[a4paper, 10pt]{article}
%\usepackage[utf8]{inputenc}			
\usepackage[english]{babel}		% for german	
\usepackage{graphicx}								
\usepackage{parskip}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{empheq}
\usepackage{titlesec}	
\usepackage{tikz}
\usetikzlibrary{arrows, snakes,shapes}
%\usepackage{tabularx}
%\usepackage{pdfpages}
%\usepackage{hyperref,breakurl}
%\usepackage{url}
%\usepackage{psfrag}
\usepackage{epstopdf}
\usepackage{dsfont}
\usepackage{sectsty}
\allsectionsfont{\bfseries\sffamily}

\addtolength{\textwidth}{2.1cm}
\addtolength{\topmargin}{-1.4cm}
\addtolength{\oddsidemargin}{-1.1 cm}
\definecolor{leichtgrau}{gray}{0.91}
\setlength{\parindent}{0pt}

% \lstset{language = C,
	% basicstyle=\footnotesize,       
	% numbers=left,                  
	% numberstyle=\footnotesize,      
	% stepnumber=2,
	% numbersep=5pt,
	% backgroundcolor=\color{leichtgrau},
	% frame=single,
% }

% Definition von römischen Zahlen
\makeatletter
\newcommand{\rmnum}[1]{\romannumeral #1}
\newcommand{\Rmnum}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother
%\renewcommand{\familydefault}{\sfdefault}


\begin{document}
\setcounter{section}{2}
\section{Multiuser MIMO}
\begin{itemize}
	\item We distinguish two cases:
	\begin{itemize}
		\item multipoint\,-\,to\,-\,point transmission
		\item point\,-\,to\,-\,multipoint transmission
	\end{itemize}
	\item Multipoint\,-\,to\,-\,point transmission
	\begin{itemize}
		\item typical uplink scenario in cellular systems
		\item information theoretical channel model: Multiple Access Channel (MAC)
		\begin{figure}[h]\centering
			\includegraphics[scale=0.8]{MAC}
		\end{figure}
%		\begin{tikzpicture}
%			\node (user1) at (0,0) [draw] {User 1};
%			\node (user2) at (1,-1)[draw] {User 2};
%			\node (user3) at (2,-2)[draw] {User 3};		
%			\draw[-<] (user1.east) --(1,0) --(1,0.5);        
%			\draw[-<] (user2.east) --(2,-1) --(2,-0.5); 
%			\draw[-<] (user3.east) --(3,-2) --(3,-1.5); 
%			\node[draw, minimum width = 2cm, minimum height = 2.5cm, font = \bfseries\large] (Joint_Receiver) at (10,-1) {Joint Receiver};
%			\path[draw,-<] ([xshift = 0cm, yshift = 0.5cm] Joint_Receiver.west)--([xshift = -1cm, yshift = 0.5cm] Joint_Receiver.west);
%			\path[draw,-<] (Joint_Receiver.west)--([xshift = -1cm, yshift = 0cm] Joint_Receiver.west) ;
%			\path[draw,-<] ([xshift = 0cm, yshift = -0.5cm] Joint_Receiver.west)--([xshift = -1cm, yshift = -0.5cm] Joint_Receiver.west);
%			\path[draw,->,>=stealth'] ([xshift = 0.6cm,yshift = 0.4cm] user1.east)--([xshift = -2.5cm, yshift = 0.5cm] Joint_Receiver.west);
%			\path[draw,->,>=stealth'] ([xshift = 0.6cm,yshift = 0.4cm] user2.east)--([xshift = -2.5cm, yshift = 0cm] Joint_Receiver.west);
%			\path[draw,->,>=stealth'] ([xshift = 0.6cm,yshift = 0.4cm] user3.east)--([xshift = -2.5cm, yshift = -0.5cm] Joint_Receiver.west);
%		\end{tikzpicture}
	\end{itemize}
	\item Point\,-\,to\,-multipoint transmission
	\begin{itemize}
		\item typical downlink scenarion in cellular systems
		\item information theoretical channel model: Broadcast Channel (BC)
		\begin{figure}[h]\centering
			\includegraphics[scale=0.8]{BC}
		\end{figure}	
	\end{itemize}
	\item Advantage of multiuser MIMO compared to point\,-\,to\,-\,point MIMO
	\begin{itemize}
		\item multiplexing gain can be exploited even if users have only single antenna
		\item users are spatially distributed in cell $\rightarrow $ channels to different users are independent
	\end{itemize}
\end{itemize}
\subsection{Multiple Access Channel (MAC)}
We consider two aspects:
\begin{itemize}
	\item Detector structures
	\item Rate region
\end{itemize}
\subsubsection{Detector structures}
\paragraph*{Channel model:}
\begin{figure}[h]\centering
	\includegraphics[scale=0.8]{Detector_Structures_Channel_Model}
\end{figure}
$\rightarrow  $ general MAC: $\mathbf{y} = \sum\limits_{k = 1}^{K}\mathbf{H}_k\mathbf{x}_k + \mathbf{n} $\\
with: \begin{itemize}
	\item K users
	\item user $k $ has $N_{T,k} $ transmit antennas
	\item $N_R $ receive antennas
	\item $\mathbf{H}_k \in \mathbb{C}^{N_R\times N_{T,k}} $ 
\end{itemize}
\begin{align*}
	\mathbf{y} = 
	\underbrace{
	\begin{bmatrix}\mathbf{H}_1 & \mathbf{H}_2 & \ldots & \mathbf{H}_k 	
	\end{bmatrix}
	}_{\mathbf{H}}\cdot
	\underbrace{
	\begin{bmatrix}\mathbf{x}_1 \\ \vdots \\ \mathbf{x}_k		
	\end{bmatrix}}_{\mathbf{x}} + \mathbf{n}
\end{align*}
\paragraph*{Observation:}
\begin{itemize}
	\item same equivalent channel model as for a point\,-\,to\,-\,point MIMO system transmitting $N_T = \sum_{k = 1}^{K} N_{T,k} $ independent signal streams \quad \textit{(Anmerkung: kein Unterschied f\"ur Empf\"anger, ob Signale von einem Nutzer oder von mehreren)}
	\item the receiver (e.g. base station) can use detection schemes as for point\,-\,to\,-\,point MIMO systems
	\begin{itemize}
		\item linear receiver
		\item DFG
		\item sphere decoder
	\end{itemize}
\end{itemize}
\paragraph*{Typical problems in uplink multiuser MIMO}
For given receiver structure:
\begin{itemize}
	\item calculate $\text{SNR}_k $ for all users $k $ based on the expressions developed in Chapter 2.4
	\item optimize transmit power of users, $E_k = \mathcal{E}\bigl\{||x_k||^2\bigr\} $ for maximization of the sumrate or maximization of the minimum $\text{SNR}_k $ \quad \textit{(Anmerkung: Maximierung der \textit{sumrate} kann durch Maximierung des SNR des Users mit bestem Kanal erfolgen, aber: unfair anderen Usern gegen\"uber $\Rightarrow $ \textit{starving})}
\end{itemize}
\subsubsection{Rate region}
For point\,-\,to\,-\,point links, we can decode error free, if the rate, $R$, meets
  \begin{itemize}
     \item[a)] SISO	$R < \log_2\bigl(1+\frac{\mathcal{E}_s}{\sigma_n^2}	\bigr) $
     \item[b)] MIMO $R < \log_2\underbrace{\bigl|\mathbf{I} + \frac{\mathcal{E}_s}{N_T\sigma_n^2} \mathbf{HH}^H\bigr|}_{\text{det}} $
	\end{itemize} 
Questions: What happens if there are multiple users?
\paragraph{Rate Region for Single Antenna Users and Receivers}
\begin{itemize}
	\item Gaussian channel
	\item $N_R = N_{T,k} = 1 \forall	k $
	\item received signal: 
	\begin{align*}
		y &= \sum\limits_{k = 1}^{K}x_k + n\\ * \mathcal{E}_k &= \mathcal{E}\bigl\{||x_k||^2\bigr\} \\ *\sigma_n^2 &= \bigl\{||n||^2\bigr\}
	\end{align*}
\end{itemize}
\subparagraph*{Example: 2 Users}
\begin{figure}[h]\centering
	\includegraphics[scale=0.6]{Rate_Region_Example}
\end{figure}
\begin{itemize}
	\item How should we choose $R_1 $ and $R_2 $ to ensure error free decoding of \underline{both} signal streams?
	\item It is no longer sufficient to maximizie a single rate. Instead we have to consider rate pairs $(R_1, R_2)$
	\item All possible rate points, that allows error free decoding, define the rate region $\underline{C} $
	\item Possible desing goals of the system:
	\begin{itemize}
		\item maximized sumrate $R_{\text{sum}} = \underset{(R_1, R_2) \in \underline{C}}{\text{max}} R_1 + R_2 $ 
		\item maximize minimum user rate: $R_{\text{max-min}} = \underset{(R_1, R_2) \in \underline{C}}{\text{max}} \, \underset{i \in \{1, 2\}}{\text{min}} R_i $ 
	\end{itemize}
	\item Rate Region of two user Gaussian MAC \quad\textit{Anmerkung: Einschr\"ankungen}
	\begin{align}
		R_1 &< \log_2\bigl(1 + \frac{\mathcal{E}_1}{\sigma_n^2}\bigr) \label{eq:Formel_1}\\ 
		R_2 &< \log_2\bigl(1 + \frac{\mathcal{E}_2}{\sigma_n^2}\bigr)\label{eq:Formel_2} \\ 
		R_1 + R_2 &< \log_2\bigl(1 + \frac{\mathcal{E}_1 + \mathcal{E}_2}{\sigma_n^2}\bigr) 	\label{eq:Formel_3}	
	\end{align}
	\item Interpretation:
	\begin{itemize}
		\item \eqref{eq:Formel_1} and \eqref{eq:Formel_2}  (= single\,-to\,user constraint) are the ``single\,-\,user bounds´´, i.e., the maximum rates of user 1 and 2, if the other user was not there
		\item \eqref{eq:Formel_3} can be interpreted as the maximum rate if streams of users 1 and 2 were jointly encoded. The separate encoding in the MAC cannot yield a better performance
		\item Graphical represantation: \\
		\begin{tikzpicture}
		\tikzstyle{every node} = [font = \small]
			\path[draw,->,>=stealth'](0,-0.3)--
				(0,3) node [left] {$\log_2(1+\frac{\mathcal{E}_2}{\mathcal{E}_1 + \sigma_n^2})$}--
				(0,4) node [left] {$\log_2(1+\frac{\mathcal{E}_2}{\sigma_n^2})$}--
				(0,2) node [right] {achievable rate}--		
				(0,6) node [left] {$R_2$};
			\path[draw,->,>=stealth'](-0.3,0)--
				(3,0) node [above] {$\log_2(1+\frac{\mathcal{E}_1}{\mathcal{E}_2 + \sigma_n^2})$}--
				(4,0) node [below] {$\log_2(1+\frac{\mathcal{E}_1}{\sigma_n^2})$}--
				(6,0) node [below] {$R_1$};
			\path[draw](4,0)--
				(4,0.2) node [right] {D}--
				(4,2.8) node [left] {C}--
				(4,3) node {};
			\path[draw,dashed](3,0)--
				(3,4) node [above] {B};
			\path[draw](0,4)--
				(0.2,4) node [above] {A}--
				(3,4) node {};
			\path[draw,dashed](0,3)--
				(4,3) node {};
			\path[draw](3,4)--
				(4,3) node [above] {dominant face};
			\path[draw,dashed](1,6)--
				(6,1) node [above] {$R_1 + R_2 = \log_2(1 + \frac{\mathcal{E}_1 + \mathcal{E}_2}{\sigma_n^2}) $};
		\end{tikzpicture}
	\end{itemize}
	
	\item Observations:
	\begin{itemize}
		\item A\,-\,B is defined by \eqref{eq:Formel_2}
		\item C\,-\,D is defined by \eqref{eq:Formel_1}
		\item B\,-\,C is defined by \eqref{eq:Formel_3}
		\item A\,-\,B suggests that even if user 2 transmits with the same max. rate as in the single user case, user 1 can transmit with non-zero rate! $\rightarrow $ Multiuser communication enables ``free´´ rate gains!
		\item Which point on A\,-\,B\,-\,C,-\,D we choose, depends on the design criterion 	
	\end{itemize}		
	\item How do we achieve points on 	A\,-\,B\,-\,C,-\,D? 
	\begin{itemize}
		\item Both user use Gaussian codebooks
		\item B: 
		\begin{itemize}
			\item signal of user 1, $x_1$, is decoded first and $x_2 $ is treated as noise:
			\begin{align*}
				y &= x_1 + \underbrace{x_2 + n}_{\text{treat as noise}}\\ \rightarrow R_1 &< \log_2\bigl(1 + \frac{\mathcal{E}_1}{\mathcal{E}_2 + \sigma_n^2}\bigr)
			\end{align*}
			\item once $x_1 $ is known, we form 
			\begin{align*}
				y -x_1 &= x_2 + n\\ \rightarrow R_2 &< \log_2\bigl(1 + \frac{\mathcal{E}_s}{\sigma_n^2}\bigr)
			\end{align*}
			\item this approach is referred to as successive interference cancellation (SIC) and is a direct result of the chain rule in information theory:\\ $I(X_1, X_2, Y) = I(X_1, Y) + I(X_2; Y|X_1) $
		\end{itemize}
		\item C: same as B, but $X_1 $ and $X_2 $ change rules
		\item Points on A\,-\,B, C\,-\,D can be achieved by decreasing the rate of users 1 and 2 respectively (not desirable)
		\item Points on B\,-\,C (dominant face): Achievable by ``time-sharing´´, i.e., $\theta\cdot 100\% $ of the time we decode user 1 first and $(1 - \theta)100\% $ of the time we decode user 2 first, $ 0\leq \theta \leq 1 $ 
		\begin{align*}
			R_1 &< \theta\log_2\bigl(1 + \frac{\mathcal{E}_1}{\mathcal{E}_2 + \sigma_n^2}\bigr) + \bigl(1-\theta\bigr)\log_2\bigl(1 + \frac{\mathcal{E}_1}{\sigma_n^2}\bigr)\\
			R_2 &< \theta\log_2\bigl(1 + \frac{\mathcal{E}_2}{\sigma_n^2}\bigr) + \bigl(1-\theta\bigr)\log_2\bigl(1 + \frac{\mathcal{E}_2}{\mathcal{E}_1 + \sigma_n^2}\bigr)\\
			\rightarrow R_1 + R_2 &< \theta\Bigl(\log_2\bigl( 1 + \frac{\mathcal{E}_1}{\mathcal{E}_2 + \sigma_n^2}\bigr) + \log_2\bigl(1 + \frac{\mathcal{E}_2}{\sigma_n^2}\bigr)\Bigr) + \\ &+ \bigl( 1- \theta\bigr) \Bigl(\log_2\bigl(1 + \frac{\mathcal{E}_1}{\sigma_n^2}\bigr) + \log_2\bigl(1 + \frac{\mathcal{E}_2}{\mathcal{E}_1 + \sigma_n^2}\bigr)\Bigr) = \\ &= \theta\log_2\Bigl(\frac{\mathcal{E}_1 + \mathcal{E}_2 + \sigma_n^2}{\mathcal{E}_2 + \sigma_n^2}\cdot\frac{\mathcal{E}_2 + \sigma_n^2}{\sigma_n^2}\Bigr) \cdot\bigl(1 - \theta\bigr)\log_2\Bigl(\frac{\mathcal{E}_1 + \sigma_n^2}{\sigma_n^2} \cdot\frac{\mathcal{E}_1 + \mathcal{E}_2 + \sigma_n^2}{\mathcal{E}_1 + \sigma_n^2} = \\ &= \log_2\Bigl( 1 + \frac{\mathcal{E}_1 + \mathcal{E}_2}{\sigma_n^2}\Bigr)
		\end{align*}
	\end{itemize}
	\item Comparison with orthogonal transmission
	\begin{itemize}
		\item User 1 transmits for $\theta\cdot 100\% $ of the time and user 2 transmits for $(1-\theta)\cdot 100\%  $ of the time, $0\leq \theta\leq 1 $
		\item to keep average transmit power independent of $\theta$, the users transmit with powers $\frac{\mathcal{E}_1}{\theta} $ and $\frac{\mathcal{E}_2}{1 - \theta} $ 
		\item Rates: 
		\begin{align*}
			R_1 &< \theta\log_2\Bigl( 1 + \frac{\mathcal{E}_1}{\theta\sigma_n^2}\Bigr)\\
			R_2 &< \bigl(1 - \theta\bigr)\log_2\Bigl( 1 + \frac{\mathcal{E}_2}{(1 - \theta)\sigma_n^2}\Bigr)
		\end{align*}
		\item[] multiuser:\\
			\begin{tikzpicture}
				\path[draw,<->,>=stealth'] node[left] {}(0,5)  -- node[sloped, above] {$\mathcal{E}_1$} (10,5) node[right]{ user 1};
				\path[draw,<->,>=stealth'] (0,4)  -- node[sloped, above] {$\mathcal{E}_2$} (10,4) node[right]{ user 2};
			\end{tikzpicture}
		\item[] orthogonal:\\
			\begin{tikzpicture}
				\path[draw,<->,>=stealth']node[left] {} (0,3)  -- node[sloped, above] {$\frac{\mathcal{E}_1}{\theta}$}(4,3) ;
				\path[draw,<->,>=stealth']node{}(4,3) --node[sloped,above]{non-transmission period: $1 -\theta$}(10,3) node[right]{ user 1} ;
				\path[draw,<->,>=stealth']node{}(0,2)--node[sloped,above]{non-transmission period: $\theta$}(4,2);
				\path[draw,<->,>=stealth'] (4,2)  -- node[sloped, above] {$\frac{\mathcal{E}_2}{1 - \theta}$} (10,2)  node[right]{ user 2};
			\end{tikzpicture}
			\item sumrate:
			\begin{align*}
				R_1 + R_2 < \theta\log_2\Bigl(1 + \frac{\mathcal{E}_1}{\theta\sigma_n^2}\Bigr) + \bigl(1-\theta\bigr)\log_2\Bigl(1 + \frac{\mathcal{E}_2}{(1-\theta)\sigma_n^2}\Bigr) = R_{\text{sum}} 
			\end{align*}			
			\item Which $\theta $ maximizes sumrate?
			\begin{align*}
				\frac{\delta R_{\text{sum}}}{\delta\theta} \overset{!}{=}  0 \text{ leads to } \theta_{\text{opt}} = \frac{\mathcal{E}_1}{\mathcal{E}_1 + \mathcal{E}_2}	
			\end{align*}			 
			\item Maximum sumrate
			\begin{align*}
				R_{\text{sum}} &= \frac{\mathcal{E}_1}{\mathcal{E}_1 + \mathcal{E}_2}\log_2\Bigl(1 + \frac{\mathcal{E}_1 + \mathcal{E}_2}{\sigma_n^2}\Bigr) + \frac{\mathcal{E}_2}{\mathcal{E}_1 + \mathcal{E}_2}\log_2\Bigl(1 + \frac{\mathcal{E}_1 + \mathcal{E}_2}{\sigma_n^2}\Bigr) = \\ &= \log_2\Bigl(1 + \frac{\mathcal{E}_1 + \mathcal{E}_2}{\sigma_n^2}\Bigr)\\
				&\rightarrow \text{ same value as for general non-orthogonal transmission!}
			\end{align*}
			\item \underline{But:} In general, orthogonal transmission is suboptimal!\\
			\begin{tikzpicture}
			\tikzstyle{every node} = [font = \small]
				\path[draw,->,>=stealth'] (0,-0.3)--
					(0,4) node [left] {$R_2$};
				\path[draw,->,>=stealth'] (-0.3,0)--
					(5,0) node [below] {$R_1$};
				\path[draw] (0, 3)--
					(2,3) node {} --
					(4,2) node {}--
					(4,1.5) node [right] {non-orthogonal}--
					(4,0) node {};			
				\path[draw,dashed] (0,3) --
					(1.5,11/4) node[below] {orthogonal}--
					(3,2.5) node {}--
					(4,0) node{};
				\node[right] at (3,2.5) {optimal $\theta = \theta_{\text{opt}}$};
					\pgfsetplotmarksize{0.3ex}
					\pgfplothandlermark{\pgfuseplotmark{*}}
					\pgfplotstreamstart
					\pgfplotstreampoint{\pgfpoint{3cm}{2.5cm}}
					\pgfplotstreamend	
			\end{tikzpicture}	
	\end{itemize}
	\item 3 users case:
	\begin{align*}
		R_1 &< \log_2\Bigl(1 + \frac{\mathcal{E}_1}{\sigma_n^2}\Bigr)\\
		R_2 &< \log_2\Bigl(1 + \frac{\mathcal{E}_2}{\sigma_n^2}\Bigr)\\
		R_3 &< \log_2\Bigl(1 + \frac{\mathcal{E}_3}{\sigma_n^2}\Bigr)\\
		R_i + R_j &< \log_2\Bigl(1 + \frac{\mathcal{E}_i + \mathcal{E}_j}{\sigma_n^2}\Bigr),\quad i\neq j\\
		R_1 + R_2 + R_3 &< \log_2\Bigl(1 + \frac{\mathcal{E}_1 + \mathcal{E}_2 + \mathcal{E}_3}{\sigma_n^2}\Bigr)\\
		&\rightarrow \text{rate region } \mathbf{\mathcal{C}} \text{ has } 3! = 6 \text{ corner points}
	\end{align*}
	\item general case of K users
	\begin{itemize}
		\item define all non-empty subsets of $\mathbf{K} = \bigl\{1,\ldots, K\bigr\} $ as $ \mathbf{S} \in \mathbf{K}$,\\  e.g. $K = 2$: $\mathbf{K} = \bigl\{1, 2\bigr\}, \mathbf{S} = \bigl\{\{1\}, \{2\}, \{1, 2\}\bigr\} $ 
	\end{itemize}
	\item rate region $\mathbf{\mathcal{C}} $  is defined by
	\begin{align*}
		\sum_{k \in \mathbf{S}}R_k < \log_2\Bigl(1 + \frac{\sum_{k\in\mathbf{S}\mathcal{E}_k}}{\sigma_n^2}\Bigr)\quad\forall\, \mathbf{S}
	\end{align*}
	\item[$\rightarrow$] $\mathbf{\mathcal{C}} $  has $ K! $ corner points which can all be achieved by successive interference cancellation (SIC) 
\end{itemize}

\end{document}



				